{"version":3,"sources":["menus/ContextMenu.js"],"names":["define","Vector2","geom","Widget","actions","ButtonMenu","DropdownMenu","ContextMenu","inherit","_construct","parent","prototype","call","this","self","_elm","style","overflow","zIndex","onmouseleave","destroy","offset","items","setText","text","removeItem","index","length","splice","addItem","name","callback","button","setAlignment","Text","LEFT","position","x","setOnClick","push","addMenu","menu","setDirection","showArrow","setMargin","updateItems","i","size","copy","set","y","updateInterface","updateSize","width","height","updatePosition","top","left","out","testAxis","menus"],"mappings":";;;;;;;AAAAA,QACC,iCACA,oBACA,8BACA,aACA,eACA,kBACC,SACDC,EACAC,EAEAC,EACAC,EACAC,EACAC,GAEA,aASA,IAAIC,EAAcJ,EAAOK,SAExBC,WAAa,SAAUC,GACtBP,EAAOQ,UAAUF,WAAWG,KAAKC,KAAMH,EAAQ,OAE/C,IAAII,EAAOD,KAEXA,KAAKE,KAAKC,MAAMC,SAAW,UAC3BJ,KAAKE,KAAKC,MAAME,OAAS,MACzBL,KAAKE,KAAKI,aAAe,WACxBL,EAAKM,WAGNP,KAAKQ,OAAS,IAAIpB,EAAQ,GAAI,IAQ9BY,KAAKS,UAUNC,QAAU,SAASC,GAClBX,KAAKW,KAAKD,QAAQC,IASnBC,WAAa,SAASC,GAClBA,GAAS,GAAKA,EAAQb,KAAKS,MAAMK,SACnCd,KAAKS,MAAMI,GAAON,UAClBP,KAAKS,MAAMM,OAAOF,EAAO,KAW3BG,QAAU,SAASC,EAAMC,GACxB,IAAIC,EAAS,IAAI3B,EAAWQ,MAC5BmB,EAAOjB,KAAKC,MAAME,OAAS,QAC3Bc,EAAOT,QAAQO,GACfE,EAAOC,aAAaC,KAAKC,MACzBH,EAAOI,SAASC,EAAI,GAEpB,IAAIvB,EAAOD,KACXmB,EAAOM,WAAW,WACjBP,IACAjB,EAAKM,YAGNP,KAAKS,MAAMiB,KAAKP,IAUjBQ,QAAU,SAASV,GAClB,IAAIW,EAAO,IAAInC,EAAaO,MAS5B,OARA4B,EAAKlB,QAAQO,GACbW,EAAKC,aAAapC,EAAa6B,MAC/BM,EAAKE,YACLF,EAAKR,aAAaC,KAAKC,MACvBM,EAAKG,UAAU,IAEf/B,KAAKS,MAAMiB,KAAKE,GAETA,GAQRI,YAAc,WACb,IAAI,IAAIC,EAAI,EAAGA,EAAIjC,KAAKS,MAAMK,OAAQmB,IAErCjC,KAAKS,MAAMwB,GAAGC,KAAKC,KAAKnC,KAAKkC,MAC7BlC,KAAKS,MAAMwB,GAAGV,SAASa,IAAI,EAAGpC,KAAKkC,KAAKG,EAAIJ,GAC5CjC,KAAKS,MAAMwB,GAAGK,mBAIhBC,WAAa,WACZvC,KAAKE,KAAKC,MAAMqC,MAAQxC,KAAKkC,KAAKV,EAAI,KACtCxB,KAAKE,KAAKC,MAAMsC,OAAUzC,KAAKkC,KAAKG,EAAIrC,KAAKS,MAAMK,OAAU,KAE7Dd,KAAKgC,eAGNU,eAAiB,WAChB1C,KAAKE,KAAKC,MAAMwC,IAAO3C,KAAKuB,SAASc,EAAIrC,KAAKQ,OAAO6B,EAAK,KAC1DrC,KAAKE,KAAKC,MAAMyC,KAAQ5C,KAAKuB,SAASC,EAAIxB,KAAKQ,OAAOgB,EAAK,KAK3D,IAAIqB,EAAMxD,EAAKyD,SAAS9C,KAAKE,MAChB,IAAV2C,EAAIrB,IAENxB,KAAKE,KAAKC,MAAMyC,KAAQ5C,KAAKuB,SAASC,EAAIxB,KAAKQ,OAAOgB,EAAIxB,KAAKkC,KAAKV,EAAK,MAE7D,IAAVqB,EAAIR,IAENrC,KAAKE,KAAKC,MAAMwC,IAAO3C,KAAKuB,SAASc,EAAIrC,KAAKQ,OAAO6B,EAAIQ,EAAIR,EAAK,SAMrE,OAAO9C,EAAQwD,MAAMrD,YAAcA","file":"../../menus/ContextMenu.js","sourcesContent":["define([\r\n\t\"skylark-langx-numerics/Vector2\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-widgets-base/Widget\",\r\n\t\"../actions\",\r\n\t\"./ButtonMenu\",\r\n\t\"./DropdownMenu\"\r\n],function(\r\n\tVector2,\r\n\tgeom,\r\n\r\n\tWidget,\r\n\tactions,\r\n\tButtonMenu,\r\n\tDropdownMenu\r\n){\r\n\t\"use strict\";\r\n\r\n\t/**\r\n\t * Context menu widget.\r\n\t * \r\n\t * @class ContextMenu\r\n\t * @extends {Widget}\r\n\t * @param {Widget} parent Parent widget.\r\n\t */\r\n\tvar ContextMenu = Widget.inherit({\r\n\r\n\t\t_construct : function (parent) {\t\r\n\t\t\tWidget.prototype._construct.call(this, parent, \"div\");\r\n\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis._elm.style.overflow = \"visible\";\r\n\t\t\tthis._elm.style.zIndex = \"300\";\r\n\t\t\tthis._elm.onmouseleave = function()\t{\r\n\t\t\t\tself.destroy();\r\n\t\t\t};\r\n\r\n\t\t\tthis.offset = new Vector2(20, 10);\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * Items in this menu.\r\n\t\t\t * \r\n\t\t\t * @attribute items\r\n\t\t\t * @type {Array}\r\n\t\t\t */\r\n\t\t\tthis.items = [];\r\n\t\t},\r\n\r\n\r\n\t\t/**\r\n\t\t * Set the text of this context menu.\r\n\t\t * \r\n\t\t * @method setText\r\n\t\t * @param {String} text\r\n\t\t */\r\n\t\tsetText : function(text) {\r\n\t\t\tthis.text.setText(text);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Remove item from context menu.\r\n\t\t *\r\n\t\t * @method removeItem\r\n\t\t * @param {Number} index\r\n\t\t */\r\n\t\tremoveItem : function(index) {\r\n\t\t\tif(index >= 0 && index < this.items.length)\t{\r\n\t\t\t\tthis.items[index].destroy();\r\n\t\t\t\tthis.items.splice(index, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Add new item to context menu\r\n\t\t *\r\n\t\t * @method addItem\r\n\t\t * @param {String} name of the item\r\n\t\t * @param {Function} callback Callback function\r\n\t\t */\r\n\t\taddItem : function(name, callback) {\r\n\t\t\tvar button = new ButtonMenu(this);\r\n\t\t\tbutton._elm.style.zIndex = \"10000\";\r\n\t\t\tbutton.setText(name);\r\n\t\t\tbutton.setAlignment(Text.LEFT);\r\n\t\t\tbutton.position.x = 25;\r\n\r\n\t\t\tvar self = this;\r\n\t\t\tbutton.setOnClick(function(){\r\n\t\t\t\tcallback();\r\n\t\t\t\tself.destroy();\r\n\t\t\t});\r\n\r\n\t\t\tthis.items.push(button);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Add new menu to context menu\r\n\t\t *\r\n\t\t * @method addItem\r\n\t\t * @param {String} name of the item.\r\n\t\t * @return {DropdownMenu} The new menu created.\r\n\t\t */\r\n\t\taddMenu : function(name) {\r\n\t\t\tvar menu = new DropdownMenu(this);\r\n\t\t\tmenu.setText(name);\r\n\t\t\tmenu.setDirection(DropdownMenu.LEFT);\r\n\t\t\tmenu.showArrow();\r\n\t\t\tmenu.setAlignment(Text.LEFT);\r\n\t\t\tmenu.setMargin(25);\r\n\r\n\t\t\tthis.items.push(menu);\r\n\r\n\t\t\treturn menu;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Update all items in the menu.\r\n\t\t * \r\n\t\t * @method updateItems\r\n\t\t */\r\n\t\tupdateItems : function() {\r\n\t\t\tfor(var i = 0; i < this.items.length; i++)\r\n\t\t\t{\r\n\t\t\t\tthis.items[i].size.copy(this.size);\r\n\t\t\t\tthis.items[i].position.set(0, this.size.y * i);\r\n\t\t\t\tthis.items[i].updateInterface();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tupdateSize : function()\t{\r\n\t\t\tthis._elm.style.width = this.size.x + \"px\";\r\n\t\t\tthis._elm.style.height = (this.size.y * this.items.length) + \"px\";\r\n\r\n\t\t\tthis.updateItems();\r\n\t\t},\r\n\r\n\t\tupdatePosition : function() {\r\n\t\t\tthis._elm.style.top = (this.position.y - this.offset.y) + \"px\";\r\n\t\t\tthis._elm.style.left = (this.position.x - this.offset.x) + \"px\";\r\n\r\n\t\t\t//Check if its inside window\r\n\t\t\t\r\n\t\t\t//var out = DOMUtils.checkBorder(this._elm);\r\n\t\t\tvar out = geom.testAxis(this._elm);\r\n\t\t\tif(out.x !== 0)\r\n\t\t\t{\r\n\t\t\t\tthis._elm.style.left = (this.position.x + this.offset.x - this.size.x) + \"px\"; \r\n\t\t\t}\r\n\t\t\tif(out.y !== 0)\r\n\t\t\t{\r\n\t\t\t\tthis._elm.style.top = (this.position.y - this.offset.y - out.y) + \"px\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t});\r\n\r\n\treturn actions.menus.ContextMenu = ContextMenu;\r\n});"]}